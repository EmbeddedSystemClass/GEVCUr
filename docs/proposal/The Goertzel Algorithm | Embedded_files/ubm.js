function UBMListService(){this.containerSelector="#list-container",this.lastItemSelector="li.item.last",this.loadButtonSelector="div.button.load",this.loadButtonTextSelector=".loader-txt",this.filterSelector="select.filter-select",this.keywordSearchButtonSelector=".search a.button",this.keywordSearchInputSelector=".search input.filter-keyword",this.loadCallback="",this.appendToLast=!1,this.loadMore=function(){var t=$(_listService.loadButtonSelector);if(0!=t.length){var e=parseInt(t.attr("data-page")),a=t.attr("data-url");t.find(_listService.loadButtonTextSelector).text("Loading..."),t.off("click");var i=a.indexOf("?")>0?a+"&page="+(e+1):a+"?page="+(e+1);$.get(i,_listService.listLoaded)}},this.listLoaded=function(data){var listing=$(_listService.containerSelector),last=listing.find(_listService.lastItemSelector),html=$(data);last.length>0&&(_listService.appendToLast?last.after(html):last.before(html)),_listService.adjustPaging(),_bookmarkService.setupSaveFollowLinks(""),_bookmarkService.applySaveFollow(""),_listService.loadCallback.length>0&&eval(_listService.loadCallback)},this.adjustPaging=function(){var t=$(this.loadButtonSelector);if(0!=t.length){var e=parseInt(t.attr("data-page"));e+=1,t.attr("data-page",e),this.setupLoadButton()}},this.setupLoadButton=function(){var t=$(this.loadButtonSelector);if(0!=t.length){var e=parseInt(t.attr("data-page")),a=parseInt(t.attr("data-totalPages")),i=t.attr("data-buttonText");e<a?(t.find(this.loadButtonTextSelector).text(i),t.on("click",this.loadMore)):t.hide()}},this.applyListing=function(){$(this.containerSelector).length>0&&this.setupLoadButton()},this.applyFiltering=function(){var t=this,e=$(this.loadButtonSelector).attr("data-url");$(this.loadButtonSelector).attr("data-url",e+window.location.search),$(t.filterSelector).on("change",function(){var e="?";$(t.filterSelector).each(function(){var t=$(this).attr("data-filtername"),a=$(this).val();a.length>0&&(e+=t+"="+a+"&")}),window.location=window.location.pathname+e.substring(0,e.length-1)}),$(t.keywordSearchButtonSelector).on("click",function(e){e.preventDefault();var a=$(t.keywordSearchInputSelector).val();a.length>0&&(window.location=window.location.pathname+"?keyword="+a)})}}var _listService=new UBMListService;